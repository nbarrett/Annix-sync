import { MigrationInterface, QueryRunner } from 'typeorm';

export class CreateFlangeBoltingTables1766001700000 implements MigrationInterface {
  name = 'CreateFlangeBoltingTables1766001700000';

  public async up(queryRunner: QueryRunner): Promise<void> {
    // Create flange_bolting_materials table
    await queryRunner.query(`
      CREATE TABLE IF NOT EXISTS "flange_bolting_materials" (
        "id" SERIAL PRIMARY KEY,
        "material_group" VARCHAR NOT NULL UNIQUE,
        "stud_spec" VARCHAR NOT NULL,
        "machine_bolt_spec" VARCHAR NOT NULL,
        "nut_spec" VARCHAR NOT NULL,
        "washer_spec" VARCHAR NOT NULL
      )
    `);

    // Create flange_bolting table
    await queryRunner.query(`
      CREATE TABLE IF NOT EXISTS "flange_bolting" (
        "id" SERIAL PRIMARY KEY,
        "standard_id" INTEGER NOT NULL,
        "pressure_class" VARCHAR NOT NULL,
        "nps" VARCHAR NOT NULL,
        "num_bolts" INTEGER NOT NULL,
        "bolt_dia" DECIMAL(5,3) NOT NULL,
        "bolt_length_default" DECIMAL(5,2),
        "bolt_length_so_sw_th" DECIMAL(5,2),
        "bolt_length_lj" DECIMAL(5,2),
        CONSTRAINT "UQ_flange_bolting_standard_class_nps" UNIQUE ("standard_id", "pressure_class", "nps"),
        CONSTRAINT "FK_flange_bolting_standard" FOREIGN KEY ("standard_id") REFERENCES "flange_standards"("id") ON DELETE CASCADE
      )
    `);

    // Insert bolting materials
    await queryRunner.query(`
      INSERT INTO "flange_bolting_materials" ("material_group", "stud_spec", "machine_bolt_spec", "nut_spec", "washer_spec")
      VALUES
        ('Carbon Steel A105 (Group 1.1)', 'ASTM A193 Grade B7', 'ASTM A307 Grade B or ASTM A449', 'ASTM A194 Grade 2H', 'ASTM F436'),
        ('Stainless Steel 304 (Group 2.1)', 'ASTM A193 Grade B8 Class 1', 'ASTM A193 Grade B8 Class 1', 'ASTM A194 Grade 8', 'ASTM F844 Stainless'),
        ('Stainless Steel 316 (Group 2.2)', 'ASTM A193 Grade B8M Class 1', 'ASTM A193 Grade B8M Class 1', 'ASTM A194 Grade 8M', 'ASTM F844 Stainless')
    `);

    // Get standard IDs for ASME B16.5, B16.47A, B16.47B
    const standards = await queryRunner.query(`
      SELECT id, code FROM "flange_standards" WHERE code IN ('ASME B16.5', 'ASME B16.47 Series A', 'ASME B16.47 Series B')
    `);

    const standardMap: { [key: string]: number } = {};
    for (const std of standards) {
      if (std.code === 'ASME B16.5') standardMap['B16.5'] = std.id;
      if (std.code === 'ASME B16.47 Series A') standardMap['B16.47A'] = std.id;
      if (std.code === 'ASME B16.47 Series B') standardMap['B16.47B'] = std.id;
    }

    // B16.5 Bolting Data
    if (standardMap['B16.5']) {
      const b165Id = standardMap['B16.5'];

      // Class 150
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_so_sw_th", "bolt_length_lj")
        VALUES
          (${b165Id}, '150', '0.5', 4, 0.5, 2.25, 2.0),
          (${b165Id}, '150', '0.75', 4, 0.5, 2.25, 2.0),
          (${b165Id}, '150', '1', 4, 0.5, 2.25, 2.0),
          (${b165Id}, '150', '1.25', 4, 0.5, 2.5, 2.25),
          (${b165Id}, '150', '1.5', 4, 0.5, 2.5, 2.25),
          (${b165Id}, '150', '2', 4, 0.625, 2.75, 2.5),
          (${b165Id}, '150', '2.5', 4, 0.625, 3.0, 2.75),
          (${b165Id}, '150', '3', 4, 0.625, 3.0, 2.75),
          (${b165Id}, '150', '3.5', 8, 0.625, 3.0, 2.75),
          (${b165Id}, '150', '4', 8, 0.625, 3.25, 3.0),
          (${b165Id}, '150', '5', 8, 0.75, 3.5, 3.25),
          (${b165Id}, '150', '6', 8, 0.75, 3.5, 3.25),
          (${b165Id}, '150', '8', 8, 0.75, 4.0, 3.5),
          (${b165Id}, '150', '10', 12, 0.875, 4.25, 3.75),
          (${b165Id}, '150', '12', 12, 0.875, 4.5, 4.0),
          (${b165Id}, '150', '14', 12, 1.0, 5.0, 4.5),
          (${b165Id}, '150', '16', 16, 1.0, 5.25, 4.75),
          (${b165Id}, '150', '18', 16, 1.125, 5.5, 5.0),
          (${b165Id}, '150', '20', 20, 1.125, 5.75, 5.25),
          (${b165Id}, '150', '24', 20, 1.25, 6.25, 5.75)
      `);

      // Class 300
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_so_sw_th", "bolt_length_lj")
        VALUES
          (${b165Id}, '300', '0.5', 4, 0.5, 2.5, 2.25),
          (${b165Id}, '300', '0.75', 4, 0.625, 2.75, 2.5),
          (${b165Id}, '300', '1', 4, 0.625, 3.0, 2.5),
          (${b165Id}, '300', '1.25', 4, 0.625, 3.0, 2.75),
          (${b165Id}, '300', '1.5', 4, 0.75, 3.25, 3.0),
          (${b165Id}, '300', '2', 8, 0.625, 3.5, 3.0),
          (${b165Id}, '300', '2.5', 8, 0.75, 3.75, 3.25),
          (${b165Id}, '300', '3', 8, 0.75, 4.0, 3.5),
          (${b165Id}, '300', '3.5', 8, 0.75, 4.0, 3.5),
          (${b165Id}, '300', '4', 8, 0.75, 4.25, 3.75),
          (${b165Id}, '300', '5', 8, 0.75, 4.5, 4.0),
          (${b165Id}, '300', '6', 12, 0.75, 4.75, 4.25),
          (${b165Id}, '300', '8', 12, 0.875, 5.5, 4.75),
          (${b165Id}, '300', '10', 16, 1.0, 6.0, 5.25),
          (${b165Id}, '300', '12', 16, 1.125, 6.25, 5.5),
          (${b165Id}, '300', '14', 20, 1.125, 6.75, 6.0),
          (${b165Id}, '300', '16', 20, 1.25, 7.0, 6.25),
          (${b165Id}, '300', '18', 24, 1.25, 7.5, 6.75),
          (${b165Id}, '300', '20', 24, 1.25, 8.0, 7.0),
          (${b165Id}, '300', '24', 24, 1.5, 8.75, 7.75)
      `);

      // Class 400
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_so_sw_th", "bolt_length_lj")
        VALUES
          (${b165Id}, '400', '0.5', 4, 0.5, 2.75, 2.5),
          (${b165Id}, '400', '0.75', 4, 0.625, 3.0, 2.75),
          (${b165Id}, '400', '1', 4, 0.625, 3.25, 2.75),
          (${b165Id}, '400', '1.25', 4, 0.75, 3.25, 3.0),
          (${b165Id}, '400', '1.5', 4, 0.75, 3.5, 3.25),
          (${b165Id}, '400', '2', 8, 0.625, 3.75, 3.25),
          (${b165Id}, '400', '2.5', 8, 0.75, 4.0, 3.5),
          (${b165Id}, '400', '3', 8, 0.875, 4.25, 3.75),
          (${b165Id}, '400', '4', 8, 0.875, 4.5, 4.0),
          (${b165Id}, '400', '5', 8, 1.0, 5.0, 4.25),
          (${b165Id}, '400', '6', 12, 1.0, 5.25, 4.5),
          (${b165Id}, '400', '8', 12, 1.125, 5.75, 5.0),
          (${b165Id}, '400', '10', 16, 1.25, 6.5, 5.5),
          (${b165Id}, '400', '12', 16, 1.375, 7.0, 6.0),
          (${b165Id}, '400', '14', 20, 1.375, 7.25, 6.25),
          (${b165Id}, '400', '16', 20, 1.5, 7.75, 6.75),
          (${b165Id}, '400', '18', 24, 1.5, 8.25, 7.25),
          (${b165Id}, '400', '20', 24, 1.5, 8.75, 7.5),
          (${b165Id}, '400', '24', 24, 1.75, 9.5, 8.25)
      `);

      // Class 600
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_so_sw_th", "bolt_length_lj")
        VALUES
          (${b165Id}, '600', '0.5', 4, 0.5, 2.75, 2.5),
          (${b165Id}, '600', '0.75', 4, 0.625, 3.0, 2.75),
          (${b165Id}, '600', '1', 4, 0.625, 3.25, 2.75),
          (${b165Id}, '600', '1.25', 4, 0.75, 3.25, 3.0),
          (${b165Id}, '600', '1.5', 4, 0.75, 3.5, 3.25),
          (${b165Id}, '600', '2', 8, 0.625, 3.75, 3.25),
          (${b165Id}, '600', '2.5', 8, 0.75, 4.0, 3.5),
          (${b165Id}, '600', '3', 8, 0.875, 4.25, 3.75),
          (${b165Id}, '600', '4', 8, 0.875, 4.5, 4.0),
          (${b165Id}, '600', '5', 8, 1.0, 5.0, 4.25),
          (${b165Id}, '600', '6', 12, 1.0, 5.25, 4.5),
          (${b165Id}, '600', '8', 12, 1.125, 5.75, 5.0),
          (${b165Id}, '600', '10', 16, 1.25, 6.5, 5.5),
          (${b165Id}, '600', '12', 20, 1.25, 7.0, 6.0),
          (${b165Id}, '600', '14', 20, 1.375, 7.5, 6.5),
          (${b165Id}, '600', '16', 20, 1.5, 8.0, 7.0),
          (${b165Id}, '600', '18', 20, 1.625, 8.5, 7.5),
          (${b165Id}, '600', '20', 24, 1.625, 9.0, 7.75),
          (${b165Id}, '600', '24', 24, 1.875, 10.0, 8.75)
      `);

      // Class 900
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_so_sw_th", "bolt_length_lj")
        VALUES
          (${b165Id}, '900', '0.5', 4, 0.75, 3.25, 3.0),
          (${b165Id}, '900', '0.75', 4, 0.75, 3.5, 3.25),
          (${b165Id}, '900', '1', 4, 0.875, 3.75, 3.5),
          (${b165Id}, '900', '1.5', 4, 1.0, 4.25, 3.75),
          (${b165Id}, '900', '2', 8, 0.875, 4.5, 4.0),
          (${b165Id}, '900', '3', 8, 1.0, 5.25, 4.5),
          (${b165Id}, '900', '4', 8, 1.125, 5.75, 5.0),
          (${b165Id}, '900', '6', 12, 1.125, 6.5, 5.75),
          (${b165Id}, '900', '8', 12, 1.375, 7.5, 6.5),
          (${b165Id}, '900', '10', 16, 1.375, 8.25, 7.25),
          (${b165Id}, '900', '12', 20, 1.375, 8.75, 7.75),
          (${b165Id}, '900', '14', 20, 1.5, 9.5, 8.25),
          (${b165Id}, '900', '16', 20, 1.625, 10.0, 8.75),
          (${b165Id}, '900', '18', 20, 1.75, 10.75, 9.25),
          (${b165Id}, '900', '20', 20, 1.875, 11.5, 10.0),
          (${b165Id}, '900', '24', 20, 2.25, 13.0, 11.5)
      `);

      // Class 1500
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_so_sw_th", "bolt_length_lj")
        VALUES
          (${b165Id}, '1500', '0.5', 4, 0.75, 3.75, 3.5),
          (${b165Id}, '1500', '0.75', 4, 0.75, 4.0, 3.75),
          (${b165Id}, '1500', '1', 4, 0.875, 4.25, 4.0),
          (${b165Id}, '1500', '1.5', 4, 1.0, 5.0, 4.5),
          (${b165Id}, '1500', '2', 8, 0.875, 5.5, 4.75),
          (${b165Id}, '1500', '2.5', 8, 1.0, 6.0, 5.25),
          (${b165Id}, '1500', '3', 8, 1.125, 6.5, 5.75),
          (${b165Id}, '1500', '4', 8, 1.25, 7.25, 6.25),
          (${b165Id}, '1500', '5', 8, 1.5, 8.0, 7.0),
          (${b165Id}, '1500', '6', 12, 1.375, 8.5, 7.25),
          (${b165Id}, '1500', '8', 12, 1.625, 9.75, 8.5),
          (${b165Id}, '1500', '10', 12, 1.875, 11.0, 9.5),
          (${b165Id}, '1500', '12', 16, 2.0, 12.0, 10.5),
          (${b165Id}, '1500', '14', 16, 2.25, 13.0, 11.5),
          (${b165Id}, '1500', '16', 16, 2.5, 14.0, 12.5),
          (${b165Id}, '1500', '18', 16, 2.75, 15.0, 13.25),
          (${b165Id}, '1500', '20', 16, 3.0, 16.5, 14.5),
          (${b165Id}, '1500', '24', 16, 3.5, 19.0, 17.0)
      `);

      // Class 2500
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_so_sw_th", "bolt_length_lj")
        VALUES
          (${b165Id}, '2500', '0.5', 4, 0.75, 4.5, 4.25),
          (${b165Id}, '2500', '0.75', 4, 0.75, 4.75, 4.5),
          (${b165Id}, '2500', '1', 4, 0.875, 5.25, 4.75),
          (${b165Id}, '2500', '1.5', 4, 1.125, 6.0, 5.5),
          (${b165Id}, '2500', '2', 8, 1.0, 6.75, 6.0),
          (${b165Id}, '2500', '2.5', 8, 1.125, 7.5, 6.75),
          (${b165Id}, '2500', '3', 8, 1.25, 8.0, 7.0),
          (${b165Id}, '2500', '4', 8, 1.5, 9.0, 8.0),
          (${b165Id}, '2500', '5', 8, 1.75, 10.25, 9.0),
          (${b165Id}, '2500', '6', 8, 2.0, 11.5, 10.0),
          (${b165Id}, '2500', '8', 12, 2.0, 13.5, 12.0),
          (${b165Id}, '2500', '10', 12, 2.5, 15.5, 13.75),
          (${b165Id}, '2500', '12', 12, 2.75, 18.0, 16.0)
      `);
    }

    // B16.47 Series A Bolting Data
    if (standardMap['B16.47A']) {
      const b1647aId = standardMap['B16.47A'];

      // Class 150
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_default")
        VALUES
          (${b1647aId}, '150', '26', 24, 1.375, 6.75),
          (${b1647aId}, '150', '28', 28, 1.375, 7.0),
          (${b1647aId}, '150', '30', 28, 1.375, 7.25),
          (${b1647aId}, '150', '32', 28, 1.5, 7.5),
          (${b1647aId}, '150', '34', 32, 1.5, 7.75),
          (${b1647aId}, '150', '36', 32, 1.625, 8.0),
          (${b1647aId}, '150', '38', 32, 1.625, 8.25),
          (${b1647aId}, '150', '40', 36, 1.625, 8.5),
          (${b1647aId}, '150', '42', 36, 1.75, 8.75),
          (${b1647aId}, '150', '44', 40, 1.75, 9.0),
          (${b1647aId}, '150', '46', 40, 1.75, 9.25),
          (${b1647aId}, '150', '48', 44, 1.75, 9.5),
          (${b1647aId}, '150', '50', 44, 1.875, 9.75),
          (${b1647aId}, '150', '52', 44, 1.875, 10.0),
          (${b1647aId}, '150', '54', 44, 2.0, 10.25),
          (${b1647aId}, '150', '56', 48, 2.0, 10.5),
          (${b1647aId}, '150', '58', 48, 2.0, 10.75),
          (${b1647aId}, '150', '60', 52, 2.0, 11.0)
      `);

      // Class 300
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_default")
        VALUES
          (${b1647aId}, '300', '26', 28, 1.5, 9.25),
          (${b1647aId}, '300', '28', 28, 1.625, 9.75),
          (${b1647aId}, '300', '30', 28, 1.75, 10.25),
          (${b1647aId}, '300', '32', 28, 1.875, 10.75),
          (${b1647aId}, '300', '34', 32, 1.875, 11.0),
          (${b1647aId}, '300', '36', 32, 2.0, 11.5),
          (${b1647aId}, '300', '38', 32, 2.0, 12.0),
          (${b1647aId}, '300', '40', 36, 2.0, 12.5),
          (${b1647aId}, '300', '42', 36, 2.125, 13.0),
          (${b1647aId}, '300', '44', 40, 2.125, 13.5),
          (${b1647aId}, '300', '46', 40, 2.25, 13.75),
          (${b1647aId}, '300', '48', 44, 2.25, 14.25),
          (${b1647aId}, '300', '50', 44, 2.375, 14.75),
          (${b1647aId}, '300', '52', 48, 2.375, 15.0),
          (${b1647aId}, '300', '54', 48, 2.5, 15.5),
          (${b1647aId}, '300', '56', 52, 2.5, 16.0),
          (${b1647aId}, '300', '58', 52, 2.5, 16.5),
          (${b1647aId}, '300', '60', 52, 2.625, 17.0)
      `);

      // Class 400
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_default")
        VALUES
          (${b1647aId}, '400', '26', 28, 1.75, 10.0),
          (${b1647aId}, '400', '28', 32, 1.75, 10.5),
          (${b1647aId}, '400', '30', 32, 1.875, 11.0),
          (${b1647aId}, '400', '32', 32, 2.0, 11.5),
          (${b1647aId}, '400', '34', 36, 2.0, 12.0),
          (${b1647aId}, '400', '36', 36, 2.125, 12.5),
          (${b1647aId}, '400', '38', 36, 2.25, 13.0),
          (${b1647aId}, '400', '40', 40, 2.25, 13.5),
          (${b1647aId}, '400', '42', 40, 2.375, 14.0),
          (${b1647aId}, '400', '44', 44, 2.375, 14.5),
          (${b1647aId}, '400', '46', 44, 2.5, 15.0),
          (${b1647aId}, '400', '48', 48, 2.5, 15.5),
          (${b1647aId}, '400', '50', 48, 2.625, 16.0),
          (${b1647aId}, '400', '52', 52, 2.625, 16.5),
          (${b1647aId}, '400', '54', 52, 2.75, 17.0),
          (${b1647aId}, '400', '56', 56, 2.75, 17.5),
          (${b1647aId}, '400', '58', 56, 2.875, 18.0),
          (${b1647aId}, '400', '60', 60, 2.875, 18.5)
      `);

      // Class 600
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_default")
        VALUES
          (${b1647aId}, '600', '26', 28, 2.0, 11.5),
          (${b1647aId}, '600', '28', 32, 2.0, 12.0),
          (${b1647aId}, '600', '30', 32, 2.125, 12.5),
          (${b1647aId}, '600', '32', 36, 2.125, 13.0),
          (${b1647aId}, '600', '34', 36, 2.25, 13.5),
          (${b1647aId}, '600', '36', 36, 2.375, 14.0),
          (${b1647aId}, '600', '38', 40, 2.375, 14.5),
          (${b1647aId}, '600', '40', 40, 2.5, 15.0),
          (${b1647aId}, '600', '42', 44, 2.5, 15.5),
          (${b1647aId}, '600', '44', 44, 2.625, 16.0),
          (${b1647aId}, '600', '46', 48, 2.625, 16.5),
          (${b1647aId}, '600', '48', 48, 2.75, 17.0),
          (${b1647aId}, '600', '50', 52, 2.75, 17.5),
          (${b1647aId}, '600', '52', 52, 2.875, 18.0),
          (${b1647aId}, '600', '54', 56, 2.875, 18.5),
          (${b1647aId}, '600', '56', 56, 3.0, 19.0),
          (${b1647aId}, '600', '58', 60, 3.0, 19.5),
          (${b1647aId}, '600', '60', 60, 3.125, 20.0)
      `);

      // Class 900
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_default")
        VALUES
          (${b1647aId}, '900', '26', 28, 2.5, 14.0),
          (${b1647aId}, '900', '28', 32, 2.5, 14.5),
          (${b1647aId}, '900', '30', 32, 2.625, 15.0),
          (${b1647aId}, '900', '32', 36, 2.625, 15.5),
          (${b1647aId}, '900', '34', 36, 2.75, 16.0),
          (${b1647aId}, '900', '36', 40, 2.75, 16.5),
          (${b1647aId}, '900', '38', 40, 2.875, 17.0),
          (${b1647aId}, '900', '40', 44, 2.875, 17.5),
          (${b1647aId}, '900', '42', 44, 3.0, 18.0),
          (${b1647aId}, '900', '44', 48, 3.0, 18.5),
          (${b1647aId}, '900', '46', 48, 3.125, 19.0),
          (${b1647aId}, '900', '48', 52, 3.125, 19.5)
      `);
    }

    // B16.47 Series B Bolting Data
    if (standardMap['B16.47B']) {
      const b1647bId = standardMap['B16.47B'];

      // Class 75
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_default")
        VALUES
          (${b1647bId}, '75', '26', 28, 1.125, 5.25),
          (${b1647bId}, '75', '28', 28, 1.25, 5.5),
          (${b1647bId}, '75', '30', 28, 1.25, 5.75),
          (${b1647bId}, '75', '32', 32, 1.25, 6.0),
          (${b1647bId}, '75', '34', 32, 1.375, 6.25),
          (${b1647bId}, '75', '36', 32, 1.375, 6.5),
          (${b1647bId}, '75', '38', 32, 1.5, 6.75),
          (${b1647bId}, '75', '40', 36, 1.5, 7.0),
          (${b1647bId}, '75', '42', 36, 1.5, 7.25),
          (${b1647bId}, '75', '44', 40, 1.5, 7.5),
          (${b1647bId}, '75', '46', 40, 1.625, 7.75),
          (${b1647bId}, '75', '48', 44, 1.625, 8.0),
          (${b1647bId}, '75', '50', 44, 1.625, 8.25),
          (${b1647bId}, '75', '52', 44, 1.75, 8.5),
          (${b1647bId}, '75', '54', 48, 1.75, 8.75),
          (${b1647bId}, '75', '56', 48, 1.75, 9.0),
          (${b1647bId}, '75', '58', 52, 1.75, 9.25),
          (${b1647bId}, '75', '60', 52, 1.875, 9.5)
      `);

      // Class 150
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_default")
        VALUES
          (${b1647bId}, '150', '26', 28, 1.25, 6.0),
          (${b1647bId}, '150', '28', 28, 1.375, 6.25),
          (${b1647bId}, '150', '30', 28, 1.375, 6.5),
          (${b1647bId}, '150', '32', 32, 1.375, 6.75),
          (${b1647bId}, '150', '34', 32, 1.5, 7.0),
          (${b1647bId}, '150', '36', 32, 1.5, 7.25),
          (${b1647bId}, '150', '38', 36, 1.5, 7.5),
          (${b1647bId}, '150', '40', 36, 1.625, 7.75),
          (${b1647bId}, '150', '42', 36, 1.625, 8.0),
          (${b1647bId}, '150', '44', 40, 1.625, 8.25),
          (${b1647bId}, '150', '46', 40, 1.75, 8.5),
          (${b1647bId}, '150', '48', 44, 1.75, 8.75),
          (${b1647bId}, '150', '50', 44, 1.75, 9.0),
          (${b1647bId}, '150', '52', 48, 1.875, 9.25),
          (${b1647bId}, '150', '54', 48, 1.875, 9.5),
          (${b1647bId}, '150', '56', 52, 1.875, 9.75),
          (${b1647bId}, '150', '58', 52, 2.0, 10.0),
          (${b1647bId}, '150', '60', 52, 2.0, 10.25)
      `);

      // Class 300
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_default")
        VALUES
          (${b1647bId}, '300', '26', 28, 1.5, 8.0),
          (${b1647bId}, '300', '28', 32, 1.5, 8.25),
          (${b1647bId}, '300', '30', 32, 1.625, 8.75),
          (${b1647bId}, '300', '32', 32, 1.75, 9.25),
          (${b1647bId}, '300', '34', 36, 1.75, 9.5),
          (${b1647bId}, '300', '36', 36, 1.875, 10.0),
          (${b1647bId}, '300', '38', 36, 1.875, 10.5),
          (${b1647bId}, '300', '40', 40, 2.0, 10.75),
          (${b1647bId}, '300', '42', 40, 2.0, 11.25),
          (${b1647bId}, '300', '44', 44, 2.0, 11.5),
          (${b1647bId}, '300', '46', 44, 2.125, 12.0),
          (${b1647bId}, '300', '48', 48, 2.125, 12.25),
          (${b1647bId}, '300', '50', 48, 2.25, 12.75),
          (${b1647bId}, '300', '52', 52, 2.25, 13.0),
          (${b1647bId}, '300', '54', 52, 2.375, 13.5),
          (${b1647bId}, '300', '56', 56, 2.375, 13.75),
          (${b1647bId}, '300', '58', 56, 2.5, 14.25),
          (${b1647bId}, '300', '60', 60, 2.5, 14.5)
      `);

      // Class 400
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_default")
        VALUES
          (${b1647bId}, '400', '26', 32, 1.625, 9.0),
          (${b1647bId}, '400', '28', 32, 1.75, 9.5),
          (${b1647bId}, '400', '30', 36, 1.75, 9.75),
          (${b1647bId}, '400', '32', 36, 1.875, 10.25),
          (${b1647bId}, '400', '34', 36, 2.0, 10.75),
          (${b1647bId}, '400', '36', 40, 2.0, 11.0),
          (${b1647bId}, '400', '38', 40, 2.125, 11.5),
          (${b1647bId}, '400', '40', 44, 2.125, 12.0),
          (${b1647bId}, '400', '42', 44, 2.25, 12.25),
          (${b1647bId}, '400', '44', 48, 2.25, 12.75),
          (${b1647bId}, '400', '46', 48, 2.375, 13.0),
          (${b1647bId}, '400', '48', 52, 2.375, 13.5),
          (${b1647bId}, '400', '50', 52, 2.5, 14.0),
          (${b1647bId}, '400', '52', 56, 2.5, 14.25),
          (${b1647bId}, '400', '54', 56, 2.625, 14.75),
          (${b1647bId}, '400', '56', 60, 2.625, 15.0),
          (${b1647bId}, '400', '58', 60, 2.75, 15.5),
          (${b1647bId}, '400', '60', 64, 2.75, 15.75)
      `);

      // Class 600
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_default")
        VALUES
          (${b1647bId}, '600', '26', 32, 2.0, 10.5),
          (${b1647bId}, '600', '28', 36, 2.0, 11.0),
          (${b1647bId}, '600', '30', 36, 2.125, 11.5),
          (${b1647bId}, '600', '32', 40, 2.125, 12.0),
          (${b1647bId}, '600', '34', 40, 2.25, 12.25),
          (${b1647bId}, '600', '36', 44, 2.25, 12.75),
          (${b1647bId}, '600', '38', 44, 2.375, 13.25),
          (${b1647bId}, '600', '40', 48, 2.375, 13.5),
          (${b1647bId}, '600', '42', 48, 2.5, 14.0),
          (${b1647bId}, '600', '44', 52, 2.5, 14.5),
          (${b1647bId}, '600', '46', 52, 2.625, 14.75),
          (${b1647bId}, '600', '48', 56, 2.625, 15.25),
          (${b1647bId}, '600', '50', 56, 2.75, 15.75),
          (${b1647bId}, '600', '52', 60, 2.75, 16.0),
          (${b1647bId}, '600', '54', 60, 2.875, 16.5),
          (${b1647bId}, '600', '56', 64, 2.875, 17.0),
          (${b1647bId}, '600', '58', 64, 3.0, 17.25),
          (${b1647bId}, '600', '60', 68, 3.0, 17.75)
      `);

      // Class 900
      await queryRunner.query(`
        INSERT INTO "flange_bolting" ("standard_id", "pressure_class", "nps", "num_bolts", "bolt_dia", "bolt_length_default")
        VALUES
          (${b1647bId}, '900', '26', 36, 2.25, 12.5),
          (${b1647bId}, '900', '28', 40, 2.25, 13.0),
          (${b1647bId}, '900', '30', 40, 2.375, 13.5),
          (${b1647bId}, '900', '32', 44, 2.5, 14.0),
          (${b1647bId}, '900', '34', 44, 2.5, 14.5),
          (${b1647bId}, '900', '36', 48, 2.625, 15.0),
          (${b1647bId}, '900', '38', 48, 2.75, 15.5),
          (${b1647bId}, '900', '40', 52, 2.75, 16.0),
          (${b1647bId}, '900', '42', 52, 2.875, 16.5),
          (${b1647bId}, '900', '44', 56, 2.875, 17.0),
          (${b1647bId}, '900', '46', 56, 3.0, 17.5),
          (${b1647bId}, '900', '48', 60, 3.0, 18.0)
      `);
    }

    console.log('Flange bolting tables created and populated successfully');
  }

  public async down(queryRunner: QueryRunner): Promise<void> {
    await queryRunner.query(`DROP TABLE IF EXISTS "flange_bolting"`);
    await queryRunner.query(`DROP TABLE IF EXISTS "flange_bolting_materials"`);
  }
}
