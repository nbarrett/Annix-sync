import { MigrationInterface, QueryRunner } from 'typeorm';

export class Add3DBendRadiusData1733848000000 implements MigrationInterface {
  name = 'Add3DBendRadiusData1733848000000';

  public async up(queryRunner: QueryRunner): Promise<void> {
    // Delete existing 3D bend data if it exists
    await queryRunner.query(`
      DELETE FROM "bend_center_to_face" WHERE "bendType" = '3D'
    `);

    // Insert 3D bend radius data for all NB sizes and degrees
    // 3D radius = 3.0 × Nominal Bore
    // NB options: 40, 50, 65, 80, 100, 125, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 900, 1000, 1050, 1100, 1150, 1200
    
    const radiusMap = {
      40: 114.3,
      50: 152.4,
      65: 190.5,
      80: 228.6,
      100: 304.8,
      125: 381.0,
      150: 457.2,
      200: 609.6,
      250: 762.0,
      300: 914.4,
      350: 1066.8,
      400: 1219.2,
      450: 1371.6,
      500: 1524.0,
      550: 1676.4,
      600: 1828.8,
      650: 1981.2,
      700: 2133.6,
      750: 2286.0,
      800: 2438.4,
      900: 2743.2,
      1000: 3048.0,
      1050: 3200.4,
      1100: 3352.8,
      1150: 3505.2,
      1200: 3658.722
    };

    // Center-to-Face data from the provided 3D table (26 NB sizes × 51 degrees)
    const centerToFaceData = {
      40: [2.5, 5.0, 7.5, 11.25, 15.0, 20.0, 22.5, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 52.0, 54.0, 55.0, 56.0, 57.0, 58.0, 59.0, 60.0, 61.0, 62.0, 63.0, 64.0, 65.0, 66.0, 67.0, 68.0, 69.0, 70.0, 71.0, 72.0, 73.0, 74.0, 75.0, 76.0, 77.0, 78.0, 79.0, 80.0, 81.0, 82.0, 83.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0, 90.0],
      50: [3.3, 6.7, 10.0, 15.0, 20.1, 26.9, 30.3, 33.8, 40.8, 48.1, 55.5, 63.1, 71.1, 74.3, 77.7, 79.3, 81.0, 82.7, 84.5, 86.2, 88.0, 89.8, 91.6, 93.4, 95.2, 97.1, 99.0, 100.9, 102.8, 104.7, 106.7, 108.7, 110.7, 112.8, 114.8, 116.9, 119.1, 121.2, 123.4, 125.6, 127.9, 130.2, 132.5, 134.8, 137.2, 139.6, 142.1, 144.6, 147.2, 149.8, 152.4],
      65: [4.2, 8.3, 12.5, 18.8, 25.1, 33.6, 37.9, 42.2, 51.0, 60.1, 69.3, 78.9, 88.8, 92.9, 97.1, 99.2, 101.3, 103.4, 105.6, 107.8, 110.0, 112.2, 114.5, 116.7, 119.0, 121.4, 123.7, 126.1, 128.5, 130.9, 133.4, 135.9, 138.4, 141.0, 143.6, 146.2, 148.8, 151.5, 154.3, 157.0, 159.8, 162.7, 165.6, 168.5, 171.5, 174.6, 177.6, 180.8, 184.0, 187.2, 190.5],
      80: [5.0, 10.0, 15.0, 22.5, 30.1, 40.3, 45.5, 50.7, 61.3, 72.1, 83.2, 94.7, 106.6, 111.5, 116.5, 119.0, 121.5, 124.1, 126.7, 129.3, 132.0, 134.7, 137.4, 140.1, 142.8, 145.6, 148.5, 151.3, 154.2, 157.1, 160.1, 163.1, 166.1, 169.2, 172.3, 175.4, 178.6, 181.8, 185.1, 188.4, 191.8, 195.2, 198.7, 202.2, 205.8, 209.5, 213.2, 216.9, 220.8, 224.6, 228.6],
      100: [6.7, 13.3, 20.0, 30.0, 40.1, 53.7, 60.6, 67.6, 81.7, 96.1, 110.9, 126.3, 142.1, 148.7, 155.3, 158.7, 162.1, 165.5, 169.0, 172.4, 176.0, 179.5, 183.1, 186.8, 190.5, 194.2, 197.9, 201.7, 205.6, 209.5, 213.4, 217.4, 221.5, 225.5, 229.7, 233.9, 238.1, 242.4, 246.8, 251.3, 255.8, 260.3, 264.9, 269.7, 274.4, 279.3, 284.2, 289.2, 294.3, 299.5, 304.8],
      125: [8.3, 16.6, 25.0, 37.5, 50.2, 57.2, 75.8, 84.5, 102.1, 120.1, 138.7, 157.8, 177.7, 185.8, 194.1, 198.3, 202.6, 206.9, 211.2, 215.6, 220.0, 224.4, 228.9, 233.5, 238.1, 242.7, 247.4, 252.2, 257.0, 261.9, 266.8, 271.8, 276.8, 281.9, 287.1, 292.4, 297.7, 303.1, 308.5, 314.1, 319.7, 325.4, 331.2, 337.1, 343.1, 349.1, 355.3, 361.6, 367.9, 374.4, 381.0],
      150: [10.0, 20.0, 30.0, 45.0, 60.2, 80.6, 90.9, 101.4, 122.5, 144.2, 166.4, 189.4, 213.2, 223.0, 233.0, 238.0, 243.1, 248.2, 253.4, 258.7, 264.0, 269.3, 274.7, 280.2, 285.7, 291.3, 296.9, 302.6, 308.4, 314.2, 320.1, 326.1, 332.2, 338.3, 344.5, 350.8, 357.2, 363.7, 370.2, 376.9, 383.6, 390.5, 397.4, 404.5, 411.7, 418.9, 426.3, 433.9, 441.5, 449.3, 457.2],
      200: [13.3, 26.3, 40.0, 60.0, 80.3, 107.5, 121.3, 135.1, 163.3, 192.2, 221.9, 252.5, 284.3, 297.3, 310.6, 317.3, 324.1, 331.0, 337.9, 344.9, 352.0, 359.1, 366.3, 373.6, 380.9, 388.4, 395.9, 403.5, 411.2, 419.0, 426.8, 434.8, 442.9, 451.1, 459.4, 467.8, 476.3, 484.9, 493.6, 502.5, 511.5, 520.6, 529.9, 539.3, 548.9, 558.6, 568.5, 578.5, 588.7, 599.1, 609.6],
      250: [16.6, 31.3, 49.9, 75.1, 100.3, 134.4, 151.6, 168.9, 204.2, 240.3, 277.3, 315.6, 355.3, 371.7, 388.3, 396.7, 405.2, 413.7, 422.4, 431.1, 439.9, 448.9, 457.9, 467.0, 476.2, 485.4, 494.8, 504.4, 514.0, 523.7, 533.6, 543.5, 553.6, 563.9, 574.2, 584.7, 595.3, 606.1, 617.1, 628.1, 639.4, 650.8, 662.4, 674.2, 686.1, 692.2, 710.6, 723.1, 735.9, 748.8, 762.0],
      300: [20.0, 39.9, 59.9, 90.1, 120.4, 161.2, 181.9, 202.7, 245.0, 288.3, 332.8, 378.8, 426.4, 446.0, 465.9, 476.0, 486.2, 496.5, 506.9, 517.3, 527.9, 538.6, 549.4, 560.3, 571.4, 582.5, 593.8, 605.2, 616.8, 628.4, 640.3, 652.2, 664.4, 676.6, 689.0, 701.6, 714.4, 727.3, 740.5, 753.8, 767.3, 781.0, 794.9, 809.0, 823.3, 837.9, 852.7, 867.7, 883.0, 898.6, 914.4],
      350: [23.3, 46.6, 69.9, 105.1, 140.4, 188.1, 212.2, 236.5, 285.8, 336.4, 388.3, 441.9, 497.5, 520.3, 543.6, 555.3, 567.2, 579.2, 591.3, 603.6, 615.9, 628.4, 641.0, 653.7, 666.7, 679.6, 692.8, 706.1, 719.6, 733.2, 747.0, 760.9, 775.1, 789.4, 803.9, 818.6, 833.5, 848.6, 863.9, 879.4, 895.2, 911.1, 927.4, 943.8, 960.6, 977.5, 994.8, 1012.4, 1030.2, 1048.3, 1066.8],
      400: [26.6, 52.6, 80.0, 120.0, 160.6, 215.0, 242.6, 270.2, 326.6, 384.4, 443.8, 505.0, 568.6, 594.6, 621.2, 634.6, 648.2, 662.0, 675.8, 689.8, 704.0, 718.2, 732.6, 747.2, 761.8, 776.8, 791.8, 807.0, 822.4, 838.0, 853.6, 869.6, 885.8, 902.2, 918.8, 935.6, 952.6, 969.8, 987.2, 1005.0, 1023.0, 1041.2, 1059.8, 1078.6, 1097.8, 1117.2, 1137.0, 1157.0, 1177.4, 1198.2, 1219.2],
      450: [29.9, 59.9, 89.9, 135.1, 180.6, 241.9, 272.8, 304.1, 367.5, 432.5, 499.2, 568.1, 639.6, 669.0, 698.9, 714.0, 729.3, 744.7, 760.3, 776.0, 791.9, 807.9, 824.1, 840.5, 857.1, 873.8, 890.7, 907.8, 925.2, 942.7, 960.4, 978.4, 996.5, 1014.9, 1033.6, 1052.5, 1071.6, 1091.0, 1110.7, 1130.7, 1150.9, 1171.5, 1192.3, 1213.5, 1235.0, 1256.8, 1279.0, 1301.6, 1324.5, 1347.9, 1371.6],
      500: [33.2, 62.6, 99.8, 150.2, 200.6, 268.8, 303.2, 337.8, 408.4, 480.6, 554.6, 631.2, 710.6, 743.4, 776.6, 793.4, 810.4, 827.4, 844.8, 862.2, 879.8, 897.8, 915.8, 934.0, 952.4, 970.8, 989.6, 1008.8, 1028.0, 1047.4, 1067.2, 1087.0, 1107.2, 1127.8, 1148.4, 1169.4, 1190.6, 1212.2, 1234.2, 1256.2, 1278.8, 1301.6, 1324.8, 1348.4, 1372.2, 1384.4, 1421.2, 1446.2, 1471.8, 1497.6, 1524.0],
      550: [36.6, 73.2, 109.9, 165.1, 220.7, 295.6, 333.5, 371.6, 449.2, 528.6, 610.2, 694.4, 781.7, 817.6, 854.2, 872.7, 891.4, 910.2, 929.2, 948.5, 967.9, 987.5, 1007.3, 1027.3, 1047.5, 1068.0, 1088.7, 1109.6, 1130.7, 1152.2, 1173.8, 1195.8, 1218.0, 1240.5, 1263.3, 1286.3, 1309.7, 1333.5, 1357.5, 1381.9, 1406.7, 1431.8, 1457.3, 1483.2, 1509.4, 1536.1, 1563.3, 1590.8, 1618.9, 1647.4, 1676.4],
      600: [40.0, 79.8, 119.8, 180.2, 240.8, 322.4, 363.8, 405.4, 490.0, 576.6, 665.6, 757.6, 852.8, 892.0, 931.8, 952.0, 972.4, 993.0, 1013.8, 1034.6, 1055.8, 1077.2, 1098.8, 1120.6, 1142.8, 1165.0, 1187.6, 1210.4, 1233.6, 1256.8, 1280.6, 1304.4, 1328.8, 1353.2, 1378.0, 1403.2, 1428.8, 1454.6, 1481.0, 1507.6, 1534.6, 1562.0, 1589.8, 1618.0, 1646.6, 1675.8, 1705.4, 1735.4, 1766.0, 1797.2, 1828.8],
      650: [43.2, 86.5, 129.9, 195.1, 260.8, 349.3, 394.1, 439.2, 530.9, 624.7, 721.1, 820.6, 923.8, 966.3, 1009.5, 1031.3, 1053.4, 1075.7, 1098.2, 1120.9, 1143.8, 1167.0, 1190.4, 1214.1, 1238.0, 1262.2, 1286.6, 1311.3, 1336.3, 1361.6, 1387.3, 1413.2, 1439.4, 1466.0, 1492.9, 1520.2, 1547.9, 1575.9, 1604.3, 1633.2, 1662.4, 1692.1, 1722.2, 1752.8, 1783.9, 1815.4, 1847.5, 1880.1, 1913.2, 1946.9, 1981.2],
      700: [46.6, 93.2, 139.8, 210.2, 280.8, 376.2, 424.4, 473.0, 571.6, 672.8, 776.6, 883.8, 995.0, 1040.6, 1087.2, 1110.6, 1134.4, 1158.4, 1182.6, 1207.2, 1231.8, 1256.8, 1282.0, 1307.4, 1333.4, 1359.2, 1385.6, 1412.2, 1439.2, 1466.4, 1494.0, 1521.8, 1550.2, 1578.8, 1607.8, 1637.2, 1667.0, 1697.2, 1727.8, 1758.8, 1790.4, 1822.2, 1854.8, 1887.6, 1921.2, 1955.0, 1989.6, 2024.8, 2060.4, 2096.6, 2133.6],
      750: [49.9, 99.8, 149.8, 225.2, 301.0, 403.1, 454.7, 506.8, 612.5, 720.8, 882.0, 946.9, 1065.0, 1115.0, 1164.8, 1190.0, 1215.5, 1241.2, 1267.2, 1293.4, 1319.8, 1346.6, 1373.6, 1400.9, 1428.5, 1456.3, 1484.5, 1513.1, 1541.9, 1571.1, 1600.7, 1630.6, 1660.9, 1691.6, 1722.6, 1754.1, 1786.0, 1818.4, 1851.2, 1884.4, 1918.2, 1952.4, 1987.2, 2022.5, 2058.3, 2094.7, 2131.7, 2169.3, 2207.6, 2246.4, 2286.0],
      800: [53.2, 105.2, 160.0, 240.0, 321.2, 430.0, 485.2, 540.4, 653.2, 768.8, 887.6, 1010.0, 1137.2, 1189.2, 1242.4, 1269.2, 1296.4, 1324.0, 1351.6, 1379.6, 1408.0, 1436.4, 1465.2, 1494.4, 1523.6, 1553.6, 1583.6, 1614.0, 1644.8, 1676.0, 1707.2, 1739.2, 1771.6, 1804.4, 1837.6, 1871.2, 1905.2, 1939.6, 1974.4, 2010.0, 2046.0, 2082.4, 2119.6, 2157.2, 2195.6, 2234.4, 2274.0, 2314.0, 2354.8, 2396.4, 2438.4],
      900: [59.8, 119.8, 179.8, 270.2, 361.2, 483.8, 545.6, 608.2, 735.0, 865.0, 998.4, 1136.2, 1279.2, 1338.0, 1397.8, 1428.0, 1458.6, 1489.4, 1520.6, 1552.0, 1583.8, 1615.8, 1648.2, 1681.0, 1714.2, 1747.6, 1781.4, 1815.6, 1850.4, 1885.4, 1920.8, 1956.8, 1993.0, 2029.8, 2067.2, 2105.0, 2143.2, 2182.0, 2221.4, 2261.4, 2301.8, 2343.0, 2384.6, 2427.0, 2470.0, 2513.6, 2558.0, 2603.2, 2649.0, 2695.8, 2743.2],
      1000: [66.4, 125.2, 199.6, 300.4, 401.2, 537.6, 606.4, 675.6, 816.8, 961.2, 1109.2, 1262.4, 1421.2, 1486.8, 1553.2, 1586.8, 1620.8, 1654.8, 1689.6, 1724.4, 1759.6, 1795.6, 1831.6, 1868.0, 1904.8, 1941.6, 1979.2, 2017.6, 2056.0, 2094.8, 2134.4, 2174.0, 2214.4, 2255.6, 2296.8, 2338.8, 2381.2, 2424.4, 2468.4, 2512.4, 2557.6, 2603.2, 2649.6, 2696.8, 2744.4, 2768.8, 2842.4, 2892.4, 2943.6, 2995.2, 3048.0],
      1050: [69.8, 139.7, 209.8, 315.2, 421.3, 564.3, 636.6, 709.5, 857.5, 1009.1, 1164.9, 1325.6, 1492.4, 1560.9, 1630.7, 1666.0, 1701.7, 1737.7, 1774.0, 1810.7, 1847.8, 1885.2, 1923.0, 1961.2, 1999.8, 2038.9, 2078.4, 2118.3, 2158.7, 2199.6, 2240.9, 2282.8, 2325.2, 2368.2, 2411.7, 2455.8, 2500.4, 2545.7, 2591.6, 2638.2, 2685.5, 2733.4, 2782.1, 2831.5, 2881.7, 2932.6, 2984.4, 3037.1, 3090.6, 3145.0, 3200.4],
      1100: [73.2, 146.4, 219.8, 330.2, 441.4, 591.2, 666.9, 743.3, 898.4, 1057.1, 1220.3, 1388.8, 1563.4, 1635.3, 1708.3, 1745.4, 1782.7, 1820.4, 1858.5, 1896.9, 1935.7, 1975.0, 2014.6, 2054.6, 2095.1, 2136.0, 2177.3, 2219.2, 2261.5, 2304.3, 2347.7, 2391.5, 2436.0, 2480.9, 2526.5, 2572.7, 2619.5, 2666.9, 2715.0, 2763.8, 2813.3, 2863.6, 2914.5, 2966.3, 3018.9, 3072.3, 3126.5, 3181.7, 3237.8, 3294.8, 3352.8],
      1150: [76.5, 153.0, 229.5, 345.21, 461.4, 618.0, 697.2, 777.1, 939.2, 1105.1, 1275.7, 1451.8, 1634.4, 1709.5, 1785.9, 1824.6, 1863.6, 1903.0, 1942.9, 1983.0, 2023.6, 2064.6, 2106.0, 2147.9, 2190.2, 2232.9, 2276.2, 2319.9, 2364.2, 2408.9, 2454.2, 2500.1, 2546.5, 2593.6, 2641.2, 2689.5, 2738.4, 2788.0, 2838.3, 2889.3, 2941.0, 2993.6, 3046.9, 3101.0, 3155.9, 3211.7, 3268.5, 3326.1, 3384.7, 3444.3, 3505.2],
      1200: [79.83359804, 159.7432524, 239.8053094, 360.3526643, 481.6798893, 645.1314035, 727.7650546, 811.1191395, 980.3516052, 1153.590615, 1331.665903, 1515.492273, 1706.090088, 1784.477952, 1864.211972, 1904.61012, 1945.376995, 1986.523963, 2028.062721, 2070.005311, 2112.364132, 2155.151961, 2198.381966, 2242.067725, 2286.223245, 2330.862979, 2376.001848, 2421.655264, 2467.83915, 2514.569963, 2561.864725, 2609.74104, 2658.217131, 2707.311864, 2757.044781, 2807.436132, 2858.50691, 2910.278888, 2962.774657, 3016.01767, 3070.032281, 3124.843794, 3180.478512, 3236.963789, 3294.328086, 3352.601026, 3411.813461, 3471.997537, 3533.186766, 3595.416096, 3658.722]
    };

    // Degree options for 3D (51 degrees: 2.5° to 90°)
    const degrees = [2.5, 5, 7.5, 11.25, 15, 20, 22.5, 25, 30, 35, 40, 45, 50, 52, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90];

    // NB sizes for 3D (26 sizes: 40-1200)
    const nbSizes = [40, 50, 65, 80, 100, 125, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 900, 1000, 1050, 1100, 1150, 1200];

    // Generate all combinations of NB and degrees
    const records: string[] = [];
    for (const nb of nbSizes) {
      const radius = radiusMap[nb];
      const centerToFaceValues = centerToFaceData[nb];
      
      for (let i = 0; i < degrees.length; i++) {
        const degree = degrees[i];
        const centerToFace = centerToFaceValues[i];
        const radians = (degree * Math.PI / 180).toFixed(4);
        
        records.push(`('3D', ${nb}, ${degree}, ${centerToFace}, ${radius}, ${radians})`);
      }
    }

    // Insert in batches to avoid query too large error
    const batchSize = 500;
    for (let i = 0; i < records.length; i += batchSize) {
      const batch = records.slice(i, i + batchSize);
      await queryRunner.query(`
        INSERT INTO "bend_center_to_face" 
        ("bendType", "nominalBoreMm", "degrees", "centerToFaceMm", "radiusMm", "radians") 
        VALUES ${batch.join(',\n')}
      `);
    }
  }

  public async down(queryRunner: QueryRunner): Promise<void> {
    // Remove all 3D bend data
    await queryRunner.query(`
      DELETE FROM "bend_center_to_face" WHERE "bendType" = '3D'
    `);
  }
}
