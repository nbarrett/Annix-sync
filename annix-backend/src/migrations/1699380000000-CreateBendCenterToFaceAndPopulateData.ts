import { MigrationInterface, QueryRunner } from 'typeorm';

export class CreateBendCenterToFaceAndPopulateData1699380000000 implements MigrationInterface {
  name = 'CreateBendCenterToFaceAndPopulateData1699380000000';

  public async up(queryRunner: QueryRunner): Promise<void> {
    // Create the bend_center_to_face table
    await queryRunner.query(`
      CREATE TABLE "bend_center_to_face" (
        "id" SERIAL NOT NULL,
        "bendType" character varying(10) NOT NULL,
        "nominalBoreMm" integer NOT NULL,
        "degrees" numeric(6,2) NOT NULL,
        "centerToFaceMm" numeric(8,2) NOT NULL,
        "radiusMm" numeric(8,2) NOT NULL,
        "radians" numeric(6,4) NOT NULL,
        "createdAt" TIMESTAMP NOT NULL DEFAULT now(),
        "updatedAt" TIMESTAMP NOT NULL DEFAULT now(),
        CONSTRAINT "PK_bend_center_to_face" PRIMARY KEY ("id")
      )
    `);

    // Create unique index
    await queryRunner.query(`
      CREATE UNIQUE INDEX "IDX_bend_center_to_face_unique" ON "bend_center_to_face" ("bendType", "nominalBoreMm", "degrees")
    `);

    // Insert 1.5D bend data
    const insert1_5D = `
      INSERT INTO "bend_center_to_face" ("bendType", "nominalBoreMm", "degrees", "centerToFaceMm", "radiusMm", "radians") VALUES
      ('1.5D', 40, 11.25, 6, 57.15, 0.1963),
      ('1.5D', 40, 12.5, 6, 57.15, 0.2182),
      ('1.5D', 40, 15, 8, 57.15, 0.2618),
      ('1.5D', 40, 17.5, 9, 57.15, 0.3054),
      ('1.5D', 40, 20, 10, 57.15, 0.3491),
      ('1.5D', 40, 22.5, 11, 57.15, 0.3927),
      ('1.5D', 40, 25, 13, 57.15, 0.4363),
      ('1.5D', 40, 27.5, 14, 57.15, 0.4799),
      ('1.5D', 40, 30, 15, 57.15, 0.5236),
      ('1.5D', 40, 32.5, 17, 57.15, 0.5672),
      ('1.5D', 40, 35, 18, 57.15, 0.6109),
      ('1.5D', 40, 37.5, 19, 57.15, 0.6545),
      ('1.5D', 40, 40, 21, 57.15, 0.6981),
      ('1.5D', 40, 42.5, 22, 57.15, 0.7418),
      ('1.5D', 40, 45, 24, 57.15, 0.7854),
      ('1.5D', 40, 47.5, 25, 57.15, 0.829),
      ('1.5D', 40, 50, 27, 57.15, 0.8727),
      ('1.5D', 40, 90, 57.2, 57.15, 1.5708),
      
      ('1.5D', 50, 11.25, 8, 76.2, 0.1963),
      ('1.5D', 50, 12.5, 8, 76.2, 0.2182),
      ('1.5D', 50, 15, 10, 76.2, 0.2618),
      ('1.5D', 50, 17.5, 12, 76.2, 0.3054),
      ('1.5D', 50, 20, 13, 76.2, 0.3491),
      ('1.5D', 50, 22.5, 15, 76.2, 0.3927),
      ('1.5D', 50, 25, 17, 76.2, 0.4363),
      ('1.5D', 50, 27.5, 19, 76.2, 0.4799),
      ('1.5D', 50, 30, 20, 76.2, 0.5236),
      ('1.5D', 50, 32.5, 22, 76.2, 0.5672),
      ('1.5D', 50, 35, 24, 76.2, 0.6109),
      ('1.5D', 50, 37.5, 26, 76.2, 0.6545),
      ('1.5D', 50, 40, 28, 76.2, 0.6981),
      ('1.5D', 50, 42.5, 30, 76.2, 0.7418),
      ('1.5D', 50, 45, 32, 76.2, 0.7854),
      ('1.5D', 50, 47.5, 34, 76.2, 0.829),
      ('1.5D', 50, 50, 36, 76.2, 0.8727),
      ('1.5D', 50, 90, 76.2, 76.2, 1.5708);
    `;
    
    await queryRunner.query(insert1_5D);

    // Insert selected 2D bend data (sample entries)
    const insert2D = `
      INSERT INTO "bend_center_to_face" ("bendType", "nominalBoreMm", "degrees", "centerToFaceMm", "radiusMm", "radians") VALUES
      ('2D', 40, 11.25, 15.0, 114.3, 0.1963),
      ('2D', 40, 15, 20.0, 114.3, 0.2618),
      ('2D', 40, 20, 26.8, 114.3, 0.3491),
      ('2D', 40, 22.5, 30.3, 114.3, 0.3927),
      ('2D', 40, 25, 33.8, 114.3, 0.4363),
      ('2D', 40, 30, 40.8, 114.3, 0.5236),
      ('2D', 40, 35, 48.1, 114.3, 0.6109),
      ('2D', 40, 40, 55.5, 114.3, 0.6981),
      ('2D', 40, 45, 63.1, 114.3, 0.7854),
      ('2D', 40, 50, 71.1, 114.3, 0.8727),
      ('2D', 40, 60, 88.0, 114.3, 1.0472),
      ('2D', 40, 70, 106.7, 114.3, 1.2217),
      ('2D', 40, 80, 127.9, 114.3, 1.3963),
      ('2D', 40, 90, 152.4, 114.3, 1.5708),
      
      ('2D', 50, 11.25, 20.0, 152.4, 0.1963),
      ('2D', 50, 15, 26.8, 152.4, 0.2618),
      ('2D', 50, 20, 35.8, 152.4, 0.3491),
      ('2D', 50, 22.5, 40.4, 152.4, 0.3927),
      ('2D', 50, 25, 45.0, 152.4, 0.4363),
      ('2D', 50, 30, 54.4, 152.4, 0.5236),
      ('2D', 50, 35, 64.1, 152.4, 0.6109),
      ('2D', 50, 40, 74.0, 152.4, 0.6981),
      ('2D', 50, 45, 84.2, 152.4, 0.7854),
      ('2D', 50, 50, 94.8, 152.4, 0.8727),
      ('2D', 50, 60, 117.3, 152.4, 1.0472),
      ('2D', 50, 70, 142.3, 152.4, 1.2217),
      ('2D', 50, 80, 170.5, 152.4, 1.3963),
      ('2D', 50, 90, 203.2, 152.4, 1.5708);
    `;
    
    await queryRunner.query(insert2D);

    // Insert selected 3D bend data (sample entries)
    const insert3D = `
      INSERT INTO "bend_center_to_face" ("bendType", "nominalBoreMm", "degrees", "centerToFaceMm", "radiusMm", "radians") VALUES
      ('3D', 40, 11.25, 11.25, 114.3, 0.1963),
      ('3D', 40, 15, 15, 114.3, 0.2618),
      ('3D', 40, 20, 20.1, 114.3, 0.3491),
      ('3D', 40, 22.5, 22.7, 114.3, 0.3927),
      ('3D', 40, 25, 25.3, 114.3, 0.4363),
      ('3D', 40, 30, 30.5, 114.3, 0.5236),
      ('3D', 40, 35, 35.9, 114.3, 0.6109),
      ('3D', 40, 40, 41.5, 114.3, 0.6981),
      ('3D', 40, 45, 47.2, 114.3, 0.7854),
      ('3D', 40, 50, 53.2, 114.3, 0.8727),
      ('3D', 40, 60, 65.8, 114.3, 1.0472),
      ('3D', 40, 70, 79.3, 114.3, 1.2217),
      ('3D', 40, 80, 95.7, 114.3, 1.3963),
      ('3D', 40, 90, 114, 114.3, 1.5708),
      
      ('3D', 50, 11.25, 15, 152.4, 0.1963),
      ('3D', 50, 15, 20.1, 152.4, 0.2618),
      ('3D', 50, 20, 26.9, 152.4, 0.3491),
      ('3D', 50, 22.5, 30.3, 152.4, 0.3927),
      ('3D', 50, 25, 33.8, 152.4, 0.4363),
      ('3D', 50, 30, 40.8, 152.4, 0.5236),
      ('3D', 50, 35, 48.1, 152.4, 0.6109),
      ('3D', 50, 40, 55.5, 152.4, 0.6981),
      ('3D', 50, 45, 63.1, 152.4, 0.7854),
      ('3D', 50, 50, 71.1, 152.4, 0.8727),
      ('3D', 50, 60, 88.0, 152.4, 1.0472),
      ('3D', 50, 70, 106.7, 152.4, 1.2217),
      ('3D', 50, 80, 127.9, 152.4, 1.3963),
      ('3D', 50, 90, 152.4, 152.4, 1.5708);
    `;
    
    await queryRunner.query(insert3D);

    // Insert selected 5D bend data (sample entries)
    const insert5D = `
      INSERT INTO "bend_center_to_face" ("bendType", "nominalBoreMm", "degrees", "centerToFaceMm", "radiusMm", "radians") VALUES
      ('5D', 40, 11.25, 19.2, 190.5, 0.1963),
      ('5D', 40, 15, 25.7, 190.5, 0.2618),
      ('5D', 40, 20, 34.4, 190.5, 0.3491),
      ('5D', 40, 22.5, 38.8, 190.5, 0.3927),
      ('5D', 40, 25, 43.2, 190.5, 0.4363),
      ('5D', 40, 30, 52.3, 190.5, 0.5236),
      ('5D', 40, 35, 61.5, 190.5, 0.6109),
      ('5D', 40, 40, 71.0, 190.5, 0.6981),
      ('5D', 40, 45, 80.8, 190.5, 0.7854),
      ('5D', 40, 50, 90.9, 190.5, 0.8727),
      ('5D', 40, 60, 112.6, 190.5, 1.0472),
      ('5D', 40, 70, 136.5, 190.5, 1.2217),
      ('5D', 40, 80, 163.6, 190.5, 1.3963),
      ('5D', 40, 90, 195.0, 190.5, 1.5708),
      
      ('5D', 50, 11.25, 29.1, 254.0, 0.1963),
      ('5D', 50, 15, 38.8, 254.0, 0.2618),
      ('5D', 50, 20, 52.0, 254.0, 0.3491),
      ('5D', 50, 22.5, 58.7, 254.0, 0.3927),
      ('5D', 50, 25, 65.4, 254.0, 0.4363),
      ('5D', 50, 30, 79.0, 254.0, 0.5236),
      ('5D', 50, 35, 93.0, 254.0, 0.6109),
      ('5D', 50, 40, 107.4, 254.0, 0.6981),
      ('5D', 50, 45, 122.2, 254.0, 0.7854),
      ('5D', 50, 50, 137.6, 254.0, 0.8727),
      ('5D', 50, 60, 170.3, 254.0, 1.0472),
      ('5D', 50, 70, 206.6, 254.0, 1.2217),
      ('5D', 50, 80, 247.5, 254.0, 1.3963),
      ('5D', 50, 90, 295.0, 254.0, 1.5708);
    `;
    
    await queryRunner.query(insert5D);
  }

  public async down(queryRunner: QueryRunner): Promise<void> {
    await queryRunner.query(`DROP INDEX "IDX_bend_center_to_face_unique"`);
    await queryRunner.query(`DROP TABLE "bend_center_to_face"`);
  }
}